<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Clasificación | MCRanks</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* =================== ESTILOS GLOBALES Y TIPOGRAFÍA =================== */
        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: #121212; 
            color: #e0e0e0; 
            margin: 0;
            padding: 0;
        }

        h1 {
            text-align: center;
            color: #3498db; 
            margin: 40px 0 20px;
            text-transform: uppercase;
            font-size: 2.5em;
        }
        
        /* =================== NAVEGACIÓN Y BOTONES =================== */
        .navbar {
            background-color: #1f1f1f; 
            padding: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
            text-align: center;
        }

        .nav-button {
            background-color: #2c3e50;
            color: white;
            padding: 10px 20px;
            margin: 0 10px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            display: inline-block;
            cursor: pointer; /* Añadido para los botones de filtro */
        }

        .nav-button:hover {
            background-color: #3498db; 
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        /* Botón Activo para filtros */
        .skill-button.active {
            background-color: #e74c3c;
            box-shadow: 0 0 0 2px #fff, 0 0 0 4px #e74c3c;
            transform: translateY(-1px);
        }

        /* =================== FILTROS Y BUSCADOR (Sección principal de tu solicitud) =================== */
        .filter-controls {
            width: 95%; 
            max-width: 1100px;
            margin: 20px auto 10px; 
            padding: 15px;
            background-color: #1f1f1f;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            text-align: center;
            /* CLAVE: Asegura que esta sección esté arriba de la tabla */
            position: relative;
            z-index: 5;
        }

        #searchInput {
            width: 80%;
            max-width: 500px;
            padding: 12px 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 2px solid #3498db;
            background-color: #252525;
            color: #e0e0e0;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s;
        }

        #searchInput::placeholder {
            color: #95a5a6;
        }

        #searchInput:focus {
            border-color: #e74c3c;
        }
        
        .skill-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap; 
        }
        
        .skill-button {
            padding: 8px 15px;
            margin: 5px 8px;
            background-color: #3498db; /* Nuevo color base para filtros */
        }
        
        .skill-button:hover {
            background-color: #2980b9;
        }
        
        .clear-button {
            background-color: #95a5a6;
        }

        .clear-button:hover {
            background-color: #7f8c8d;
            box-shadow: none;
        }

        /* =================== CONTENEDOR DEL RANKING (TABLA) =================== */
        .ranking-container { 
            width: 95%; 
            max-width: 1100px;
            margin: 30px auto; 
            background-color: #1f1f1f; 
            border-radius: 10px; 
            box-shadow: 0 8px 16px rgba(0,0,0,0.4); 
            overflow: hidden; 
        }

        /* =================== CABECERA DEL RANKING =================== */
        .ranking-header {
            display: flex;
            padding: 15px 20px;
            background-color: #2c3e50; 
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 1px;
        }
        
        /* =================== FILAS DE DATOS =================== */
        .ranking-item { 
            display: flex; 
            padding: 15px 20px; 
            border-bottom: 1px solid #333; 
            align-items: center; 
            transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
            cursor: default;
        }
        .ranking-item:hover {
            background-color: #252525; 
            transform: scale(1.01);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); 
        }
        .ranking-item:last-child {
            border-bottom: none;
        }

        /* =================== ESTILOS DE COLUMNAS =================== */
        .rank, .header-rank { width: 40px; text-align: center; font-size: 1.5em; color: #3498db; }
        .avatar, .header-avatar { margin-right: 15px; width: 40px; } 

        .info, .header-info { 
            flex-grow: 1;
            text-align: left;
            padding-left: 10px;
            min-width: 150px; 
        }
        
        .header-points, .header-tier, .header-badges,
        .points-col, .tier-col, .badges-col { 
            width: 70px; 
            text-align: center; 
        }
        .badges-col { text-align: right; }

        .skill-col, .header-skill {
            width: 70px; 
            text-align: center;
            font-weight: bold;
        }
        .skill-score-good { color: #2ecc71; }
        .skill-score-avg { color: #f1c40f; }
        .skill-score-low { color: #e74c3c; }

        /* Detalles del jugador */
        .avatar img { 
            border-radius: 50%; 
            width: 40px; 
            height: 40px; 
            border: 3px solid #3498db; 
            transition: transform 0.3s ease;
        }
        .ranking-item:hover .avatar img { transform: rotate(360deg); }
        .info .name { font-weight: bold; color: #e0e0e0; font-size: 1.1em; }
        .info > div:last-child { color: #95a5a6; font-size: 0.9em; }

        .points-col strong { color: #f1c40f; }
        
        /* Tiers */
        .tier { 
            font-weight: bold; 
            padding: 4px 8px; 
            border-radius: 4px; 
            color: #1f1f1f; 
            display: inline-block;
            min-width: 40px;
            text-align: center;
        }
        .tier-S { background-color: #e74c3c; } 
        .tier-A { background-color: #f39c12; } 
        .tier-B { background-color: #2ecc71; } 
        .tier-C { background-color: #3498db; } 
        .tier-D { background-color: #95a5a6; } 

        /* Insignias */
        .badges img { 
            width: 24px; 
            height: 24px; 
            margin-left: 5px; 
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <a href="index.html" class="nav-button">Inicio</a>
        <a href="clasificacion.html" class="nav-button">Clasificación</a>
        <a href="https://discord.gg/fEYt2VMU" class="nav-button">Discord</a>
        <a href="informacion.html" class="nav-button">Información</a>
    </nav>
    
    <h1>Clasificación General de Jugadores</h1>

    <div class="filter-controls">
        <input type="text" id="searchInput" placeholder="Buscar por nombre o región..." onkeyup="filtrarRanking()">
        
        <div class="skill-buttons">
            <button class="nav-button skill-button" data-skill="bypassing" onclick="filtrarPorHabilidad('bypassing', 8, this)">Top Bypassing</button>
            <button class="nav-button skill-button" data-skill="pvp" onclick="filtrarPorHabilidad('pvp', 8, this)">Top Pvp</button>
            <button class="nav-button skill-button" data-skill="defensa" onclick="filtrarPorHabilidad('defensa', 8, this)">Top Defensa</button>
            <button class="nav-button clear-button" onclick="limpiarFiltros()">Limpiar Filtros</button>
        </div>
    </div>
    
    <div class="ranking-container">
        <div id="ranking-header" class="ranking-header"></div>
        
        <div id="ranking-body">
            <div style="text-align: center; padding: 20px;">Cargando datos...</div>
        </div>
    </div>

    <script>
        // --- DATOS DEL RANKING (JSON INTEGRADO PARA FACILIDAD) ---
        const rankingData = {
            "rankings": [
                "player1", "player2", "player3", "player4", "player5"
            ],
            "players": {
                "player1": {
                    "name": "Drufts", "region": "NA", "points": 50, "tier": "S", "avatar": "https://mc-heads.net/avatar/Drufts/50", "badges": [{ "title": "Winner", "icon": "https://img.icons8.com/color/48/000000/trophy.png" }], "skills": { "bypassing": 10, "pvp": 9, "defensa": 8 }
                },
                "player2": {
                    "name": "IllGoTosleep", "region": "EU", "points": 45, "tier": "A", "avatar": "https://mc-heads.net/avatar/IllGoToSleep/50", "badges": [{ "title": "Top Killer", "icon": "https://img.icons8.com/color/48/000000/sword.png" }], "skills": { "bypassing": 9, "pvp": 10, "defensa": 9 }
                },
                "player3": {
                    "name": "iCookedPan_", "region": "AS", "points": 40, "tier": "B", "avatar": "https://mc-heads.net/avatar/iCookedPan_/50", "badges": [], "skills": { "bypassing": 8, "pvp": 7, "defensa": 8 }
                },
                "player4": {
                    "name": "Swmu", "region": "EU", "points": 38, "tier": "B", "avatar": "https://mc-heads.net/avatar/Swmu/50", "badges": [], "skills": { "bypassing": 7, "pvp": 9, "defensa": 6 }
                },
                "player5": {
                    "name": "fakluv", "region": "NA", "points": 35, "tier": "C", "avatar": "https://mc-heads.net/avatar/fakluv/50", "badges": [{ "title": "Legend", "icon": "https://img.icons8.com/color/48/000000/medal.png" }], "skills": { "bypassing": 8, "pvp": 8, "defensa": 9 }
                }
            }
        };

        // --- REFERENCIAS DOM Y ESTADO ---
        const rankingBody = document.getElementById('ranking-body');
        const rankingHeader = document.getElementById('ranking-header');
        const searchInput = document.getElementById('searchInput');
        const skillButtons = document.querySelectorAll('.skill-button');
        
        let currentSkillFilter = null; // null, 'bypassing', 'pvp', o 'defensa'
        let currentMinScore = 0; // Puntuación mínima para el filtro de habilidad
        let currentSearchTerm = '';
        
        // --- FUNCIONES AUXILIARES ---
        function getSkillColor(score) {
            if (score >= 9) return 'skill-score-good';
            if (score >= 7) return 'skill-score-avg';
            return 'skill-score-low';
        }

        // --- RENDERIZADO DE CABECERA ---
        function renderHeader() {
            rankingHeader.innerHTML = `
                <div class="header-rank">#</div>
                <div class="header-avatar"></div>
                <div class="header-info">Jugador</div>
                <div class="header-points points-col">Puntos</div>
                <div class="header-tier tier-col">Tier</div>
                <div class="header-skill skill-col">Bypassing</div>
                <div class="header-skill skill-col">Pvp</div>
                <div class="header-skill skill-col">Defensa</div>
                <div class="header-badges badges-col">Insignias</div>
            `;
        }
        
        // --- FUNCIÓN PRINCIPAL DE RENDERIZADO Y FILTRADO ---
        function renderRanking() {
            rankingBody.innerHTML = '';
            let visibleRank = 0;

            rankingData.rankings.forEach(playerId => {
                const player = rankingData.players[playerId];
                let isVisible = true;
                
                // 1. FILTRO DE HABILIDAD
                if (currentSkillFilter && player.skills[currentSkillFilter] < currentMinScore) {
                    isVisible = false;
                }

                // 2. FILTRO DE BÚSQUEDA
                if (currentSearchTerm) {
                    const term = currentSearchTerm.toLowerCase();
                    const nameMatch = player.name.toLowerCase().includes(term);
                    const regionMatch = player.region.toLowerCase().includes(term);
                    if (!nameMatch && !regionMatch) {
                        isVisible = false;
                    }
                }

                if (isVisible) {
                    visibleRank++;
                    
                    // CREACIÓN DEL ELEMENTO DE FILA
                    const item = document.createElement('div');
                    item.className = 'ranking-item';
                    
                    item.innerHTML = `
                        <div class="rank">${visibleRank}</div>
                        <div class="avatar"><img src="${player.avatar}" alt="${player.name}"></div>
                        <div class="info">
                            <div class="name">${player.name}</div>
                            <div>Región: ${player.region}</div>
                        </div>
                        <div class="points-col"><strong>${player.points}</strong></div>
                        <div class="tier-col"><span class="tier tier-${player.tier}">${player.tier}</span></div>
                        
                        <div class="skill-col ${getSkillColor(player.skills.bypassing)}">${player.skills.bypassing}</div>
                        <div class="skill-col ${getSkillColor(player.skills.pvp)}">${player.skills.pvp}</div>
                        <div class="skill-col ${getSkillColor(player.skills.defensa)}">${player.skills.defensa}</div>
                        
                        <div class="badges-col badges">
                            ${player.badges.map(badge => `<img src="${badge.icon}" alt="${badge.title}" title="${badge.title}">`).join('')}
                        </div>
                    `;
                    rankingBody.appendChild(item);
                }
            });

            if (rankingBody.innerHTML === '') {
                rankingBody.innerHTML = `<div style="text-align: center; padding: 20px; color: #e74c3c;">¡Error! No se encontraron jugadores que coincidan con los filtros.</div>`;
            }
        }
        
        // --- MANEJADORES DE EVENTOS ---
        
        // Filtro por habilidad (al hacer clic en los botones)
        function filtrarPorHabilidad(skill, minScore, button) {
            currentSkillFilter = skill;
            currentMinScore = minScore;
            
            // Lógica para activar/desactivar botones
            skillButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            renderRanking();
        }
        
        // Limpiar filtros (al hacer clic en el botón Limpiar Filtros)
        function limpiarFiltros() {
            currentSkillFilter = null;
            currentMinScore = 0;
            currentSearchTerm = '';
            searchInput.value = '';
            
            skillButtons.forEach(btn => btn.classList.remove('active'));
            renderRanking();
        }

        // Filtro de búsqueda (al escribir en el input)
        function filtrarRanking() {
            currentSearchTerm = searchInput.value;
            renderRanking();
        }
        
        // --- INICIALIZACIÓN ---
        document.addEventListener('DOMContentLoaded', () => {
            renderHeader();
            renderRanking(); // Cargar la tabla inicial
        });
    </script>
</body>
</html>
